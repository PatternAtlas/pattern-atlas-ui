<div class="container-double">
    <mat-card *ngIf="user" class="left">
        <form (ngSubmit)="submit()" #userForm="ngForm">

            <mat-form-field>
                <input matInput [disabled]="disabled" placeholder="Username" type="text" id="name" required
                    [(ngModel)]="user.name" name="name" #name="ngModel" />
                <!-- <mat-error *ngIf="!userForm.get('name').valid">Username is required</mat-error> -->
                <mat-hint align="start">Your username</mat-hint>
            </mat-form-field>

            <mat-form-field>
                <input matInput [disabled]="disabled" placeholder="E-Mail" type="email" id="email" required
                    [(ngModel)]="user.email" name="email" #email="ngModel" />
                <!-- <mat-error *ngIf="!userForm.get('email').valid">E-Mail is required</mat-error> -->
                <mat-hint align="start">Your e-mail address</mat-hint>
            </mat-form-field>

            <mat-form-field>
                <input matInput placeholder="Role" type="text" id="role" required [(ngModel)]="user.role" name="role"
                    #role="ngModel" disabled />
            </mat-form-field>

            <form *ngIf="password" [formGroup]="passwordForm" (ngSubmit)="updatePassword()">
                <mat-form-field>
                    <input matInput placeholder="Old password" [type]="oldPasswordHide ? 'password' : 'text'"
                        formControlName="oldPassword">
                    <button mat-icon-button matSuffix (click)="oldPasswordHide = !oldPasswordHide"
                        [attr.aria-label]="'Hide password'" [attr.aria-pressed]="hide">
                        <mat-icon>{{oldPasswordHide ? 'visibility_off' : 'visibility'}}</mat-icon>
                    </button>
                    <mat-error *ngIf="!passwordForm.get('oldPassword').valid">
                        Please enter your old password
                    </mat-error>
                </mat-form-field>

                <mat-form-field>
                    <input matInput placeholder="New password" [type]="passwordHide ? 'password' : 'text'"
                        formControlName="password">
                    <button mat-icon-button matSuffix (click)="passwordHide = !passwordHide"
                        [attr.aria-label]="'Hide password'" [attr.aria-pressed]="hide">
                        <mat-icon>{{passwordHide ? 'visibility_off' : 'visibility'}}</mat-icon>
                    </button>
                    <mat-error *ngIf="!passwordForm.get('password').valid">
                        Please enter new password
                    </mat-error>
                </mat-form-field>

                <mat-form-field>
                    <input matInput placeholder="Confirm password" [type]="confirmPasswordHide ? 'password' : 'text'"
                        formControlName="confirmPassword">
                    <button mat-icon-button matSuffix (click)="confirmPasswordHide = !confirmPasswordHide"
                        [attr.aria-label]="'Hide password'" [attr.aria-pressed]="hide">
                        <mat-icon>{{confirmPasswordHide ? 'visibility_off' : 'visibility'}}</mat-icon>
                    </button>
                    <mat-error *ngIf="!passwordForm.get('confirmPassword').valid">
                        Passwords do not match
                    </mat-error>
                </mat-form-field>
            </form>

            <!-- DETAIL BUTTONS -->
            <div class="detail-component buttons" *ngIf="disabled && !password">
                <button mat-flat-button type="button" color="accent" (click)="edit()">Edit</button>
                <button mat-flat-button type="button" color="accent" (click)="editPassword()">Change Password</button>
                <button mat-flat-button type="button" color="warn" (click)="delete()">Delete</button>
            </div>
            <!-- EDIT BUTTONS -->
            <div class="detail-component buttons" *ngIf="!disabled && !password">
                <button mat-flat-button type="submit" color="primary" [disabled]="!userForm.valid">Save</button>
                <button mat-flat-button type="button" color="warn" (click)="reset()">Reset</button>
            </div>
            <!-- PASSWORD BUTTONS -->
            <div class="detail-component buttons" *ngIf="disabled && password">
                <button mat-flat-button type="button" color="primary" (click)="updatePassword()"
                    [disabled]="!passwordForm.valid">Save</button>
                <button mat-flat-button type="button" color="warn" (click)="cancelPassword()">Cancel Password</button>
            </div>
        </form>
    </mat-card>
    <mat-card *ngIf="user" class="right">
        <h3>ISSUES</h3>
        <ng-container *ngIf="user.issues && user.issues.length >= 1">
            <div class="info-item" *ngFor="let issue of user.issues" (click)="detailIssue(issue)">
                <h4>{{issue.name}}</h4>
                <p>{{issue.description}}</p>
            </div>
        </ng-container>
        <div *ngIf="!user.issues || user.issues.length == 0">
            Not author of any issues
        </div>
    </mat-card>
</div>